!function($){$.fn.rectTool=function(e){function o(){t.drawRect({fillStyle:e.color,x:r,y:s,width:n,height:a,fromCenter:!0})}var t=this;t.unbind();var n=0,a=0,r,s,u,c;t.on(e.getTouchEventName("mousedown"),function(n){return e.hist.push(e.last.src=t[0].toDataURL("image/png")),r=n.offsetX,s=n.offsetY,o(),e.drag=!0,!1}),t.on(e.getTouchEventName("mouseup"),function(){e.drag=!1,n=0,a=0,e.last.src=t[0].toDataURL("image/png")}),$(document).keydown(function(o){16===o.keyCode&&(e.press=!0)}).keyup(function(o){16===o.keyCode&&(e.press=!1)}),t.on(e.getTouchEventName("mousemove"),function(f){e.drag===!0&&t.clearCanvas().drawImage({source:e.last.src,x:0,y:0,fromCenter:!1,load:function(){u=f.offsetX+n/2,c=f.offsetY+a/2,n=u-r,a=c-s,e.press===!0&&(a=n),o()}})})}}(jQuery);